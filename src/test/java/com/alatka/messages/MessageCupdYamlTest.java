package com.alatka.messages;

import com.alatka.messages.definition.IsoYamlMessageDefinitionBuilder;
import com.alatka.messages.holder.MessageHolder;
import com.alatka.messages.message.MessageBuilder;
import com.alatka.messages.util.BytesUtil;
import org.junit.jupiter.api.*;

@DisplayName("银联数据8583报文")
public class MessageCupdYamlTest {

    @BeforeAll
    public static void beforeAll() {
        new IsoYamlMessageDefinitionBuilder().build();
    }

    private void doTest(String hex, String key) {
        MessageHolder holder = MessageBuilder.init(key).unpack(hex);
        System.out.println(holder);
        byte[] pack = MessageBuilder.init(key).pack(holder);
        Assertions.assertEquals(BytesUtil.bytesToHex(pack), hex.toUpperCase());

        MessageHolder holder1 = MessageBuilder.init(key).unpack(pack);
        Assertions.assertEquals(holder1, holder);
    }

    @Test
    @DisplayName("header")
    public void test01() {
        String hex = "2901303530383030303030303030303030303030303030303030303000000000000000000000000000";
        String key = "iso:cupd:common:header";
        this.doTest(hex, key);
    }

    @Test
    @DisplayName("还款请求报文")
    public void test02() {
        String hex = "30323030F238448188E080100000000017100060313636323833303130333030303030303139343730303030303030303030303039393030303432343133353235333030303133373133353235333034323436303134303131303030383635313931313030303836353139313130303234303432343133353235333030393939303033303030303030303030303030303030B1BED0D0B5E7BBB0D2F8D0D0D0C5D3C3BFA8BBB9BFEE202020202020202020202020202020202020313536303135202020202020202030392020202020303836353139313130303139363233313033393931393031303932383233333136363238333031303330303030303031393035385349303533011336323331303339393139303130393238323333021EC7C7D4B0D4B02020202020202020202020202020202020202020202020203031302020202020202020203130313231383332202039393930303330393741443039322020202020202020202020202020202020202020333137313130303130303139CCECBDF2C5A9B4E5C9CCD2B5D2F8D0D0B9C9B7DDD3D0CFDEB9ABCBBE2020202020202020202020202020202020202020202020202020202020202020";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    @Disabled
    @DisplayName("还款应答报文")
    public void test03() {
        String hex = "30323130F23E40918AC084000000000016000041313636323833303130333030303030303139343730303030303030303030303039393030303432343133353235333030303133373133353235333034323430303030303832343630313430304430303030303030303038363531393131303030383635313931313030323430343234313335323533303030303939393030333030303030303030303030303030303135363034303330303131353644303030303032323038393932333030323135364330303030303431383839393230383635313931313030313936323331303339393139303130393238323333313636323833303130333030303030303139303138313833322020393939303033C7C7D4B0D4B03632323133443238";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    @DisplayName("贷记卡免密消费请求")
    public void test04() {
        String hex = "30323030F238448198E080140000002011100060313636323538313930363230303030303339303030303030303030303030303036363636303432343134313432353030303134303134313432353034323436303133303132303030383635313931313030303836353139313130303030303234303432343134313432353030393938383031303030303030303030303030303030202020202020202020202020202020202020202020202020202020202020202020202020202020203135363031352020202020202020313520202020203031324441543030303034574C5A4639303836353139313130303035355349303530011039303033333130303030313730303031021ED6A7B8B6B1A6B2E2CAD4BBA72020202020202020202020202020202020203031302020202020202020203130313231383938202039393838303130393741443039322020202020202020202020202020202020202020393030333331303030303137D6A7B8B6B1A6A3A8D6D0B9FAA3A9CDF8C2E7BCBCCAF5D3D0CFDEB9ABCBBE202020202020202020202020202020202020202020202020202020202020";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    @Disabled
    @DisplayName("贷记卡免密消费应答")
    public void test05() {
        String hex = "30323130F23E40818AC0800000000000100000413136363235383139303632303030303033393030303030303030303030303030363636363034323431343134323530303031343031343134323530343234353734383038323436303133303030383635313931313030303836353139313130303234303432343134313432353537303039393838303130303030303030303030303030303031353630383635313931313030303136313839382020393938383031D5C5D3B13846323045423045";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    @Disabled
    @DisplayName("贷记IC卡预借现金请求")
    public void test06() {
        String hex = "30323030F23846C188E09A180000000010000060313636323538313930303430303031323532303130303030303030303030303234393130303432343134313835383030303134323134313835383034323436303130303131303030303030363038363531393131303030383635313931313030323430343234313431383538303030333131383830303030303030303030303030303031313839202020202020202020202020202020202020202020202020202020202020202020202020313536ABE84818E7C785613230303030303030303030303030303030303030313520202020202020203036202020202030323030313132303232323139393330313033303032353038363531393131303030313231313839202030333131383830393741443039322020202020202020202020202020202020202020333137313130303130303139CCECBDF2C5A9B4E5C9CCD2B5D2F8D0D0B9C9B7DDD3D0CFDEB9ABCBBE2020202020202020202020202020202020202020202020202020202020202020";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    @Disabled
    @DisplayName("贷记IC卡预借现金应答")
    public void test07() {
        String hex = "30323130F23E42818AC08200000000001000004131363632353831393030343030303132353230313030303030303030303030323439313030343234313431383538303030313432313431383538303432343134343030313031363031303030303030303836353139313130303038363531393131303032343034323431343138353831343030303331313838303030303030303030303030303030313536303030303836353139313130303031323131383920203033313138384132313135423641";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    @DisplayName("退货请求")
    public void test08() {
        String hex = "30323230F238448188E080140000004011100020313636323833303130333030303030303139323030303030303030303030303039393031313031323131303934343030303032303131303934343130313236303133303131303030383635313931313030303836353139313130303233313031323131303934343030393938383031303030303030303030303030303030B2C6B8B6CDA8D6A7B8B6BFC6BCBCD3D0CFDEB9ABCBBE2020202020202020202020202020202020203135363031352020202020202020313520202020203031324441543030303034574C5A46303230303030303030383130313231303533333030303036353139313130303030303635313931313030303836353139313130303035315349303436010C303030303030303030303030021EB2C6B8B6CDA8B2E2CAD4D5CBBBA7202020202020202020202020202020203031302020202020202020203130393741443039322020202020202020202020202020202020202020393030353834303030303134B2C6B8B6CDA8D6A7B8B6BFC6BCBCD3D0CFDEB9ABCBBE2020202020202020202020202020202020202020202020202020202020202020202020202020";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    @DisplayName("退货应答")
    public void test09() {
        String hex = "30323330F23A40818AC080000000000010000001313636323833303130333030303030303139323030303030303030303030303039393031313031323131303934343030303032303131303934343130313230343032363031333030303836353139313130303038363531393131303032333130313231313039343430303030393938383031303030303030303030303030303030313536303836353139313130304438303442413532";
        String key = "iso:cupd:common:payload";
        this.doTest(hex, key);
    }

    @Test
    public void test99() {
        String hex = "5349";
        System.out.println(new String(BytesUtil.hexToBytes(hex)));
        System.out.println(0x1E);
        System.out.println(BytesUtil.bytesToBinary(BytesUtil.hexToBytes("4441543030303034574C5A46")));
        System.out.println(new String(BytesUtil.hexToBytes("4441543030303034574C5A46")));
    }

}
